
#常見 404 錯誤原因
URL 路徑錯誤 - 確認是 /api/sap_upload 而不是 /sap_upload
伺服器未啟動 - 確認 Flask 應用程式正在運行
IP 或 Port 錯誤 - 確認伺服器 IP 和埠號 (5000) 正確
防火牆阻擋 - 確認防火牆允許 5000 埠
import requests
import os

# === 設定區 ===
SERVER_URL = "http://192.168.1.100:5000/api/sap_upload"  # 修改成您的伺服器IP
API_KEY = "YOUR_SECURE_API_KEY_HERE"  # 與伺服器設定的 API_KEY_SECRET 一致
FILE_PATH = r"C:\path\to\your\file.txt"  # 要上傳的檔案路徑

# === 上傳邏輯 ===
def upload_file_to_server(file_path):
    """上傳檔案到伺服器"""
    if not os.path.exists(file_path):
        print(f"錯誤: 找不到檔案 {file_path}")
        return False
    
    try:
        # 設定 headers 包含 API Key
        headers = {
            'X-API-Key': API_KEY
        }
        
        # 開啟檔案並上傳
        with open(file_path, 'rb') as f:
            files = {'file': (os.path.basename(file_path), f)}
            response = requests.post(SERVER_URL, files=files, headers=headers)
        
        # 檢查回應
        if response.status_code == 200:
            print(f"✓ 上傳成功: {response.text}")
            return True
        elif response.status_code == 404:
            print(f"✗ 404 錯誤: 端點不存在")
            print(f"  請確認 URL 是否正確: {SERVER_URL}")
            return False
        elif response.status_code == 401:
            print(f"✗ 401 錯誤: API Key 驗證失敗")
            print(f"  請確認 API_KEY 是否正確")
            return False
        else:
            print(f"✗ 上傳失敗 ({response.status_code}): {response.text}")
            return False
            
    except requests.exceptions.ConnectionError:
        print(f"✗ 連線錯誤: 無法連接到 {SERVER_URL}")
        print(f"  請確認伺服器是否正在運行，以及網路是否暢通")
        return False
    except Exception as e:
        print(f"✗ 發生錯誤: {e}")
        return False

# 執行上傳
if __name__ == "__main__":
    upload_file_to_server(FILE_PATH)

